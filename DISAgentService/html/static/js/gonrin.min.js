!function(e,a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):e.gonrin=a(e.jQuery)}(this,function e(a){"use strict";var t={},n=[].slice,i=0;t.uniqueId=function(e){var a=++i+"";return e?e+a:a},t.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var a=16*Math.random()|0,t="x"==e?a:3&a|8;return t.toString(16)})},["every","some","filter","reduce","map"].forEach(function(e){return t[e]=function(){var a,t;return t=arguments[0],a=2>arguments.length?[]:n.call(arguments,1),t[e].apply(t,a)}}),t.keys=Object.keys,t.isArray=Array.isArray,t.result=function(e,a){return null==e&&(e={}),"Function"===utils.getType(e[a])?e[a]():e[a]},t.detect=function(e,a){var t,n,i;for(n=0,i=e.length;i>n;n++)if(t=e[n],a(t))return t},t.reject=function(e,a){var t,n,i,s;for(s=[],n=0,i=e.length;i>n;n++)t=e[n],a(t)||s.push(t);return s},t.intersection=function(e,a){var t,n,i,s;for(s=[],n=0,i=e.length;i>n;n++)t=e[n],-1!==a.indexOf(t)&&s.push(t);return s},t.isEqual=function(e,a){return JSON.stringify(e)===JSON.stringify(a)},t.functions=t.methods=function(e){var a=[];for(var n in e)t.isFunction(e[n])&&a.push(n);return a.sort()},"function"!=typeof/./&&"object"!=typeof Int8Array&&(t.isFunction=function(e){return"function"==typeof e||!1}),t.mixin=function(e){a.each(t.functions(e),function(a){var n=t[a]=e[a];t.prototype[a]=function(){var e=[this._wrapped];return push.apply(e,arguments),result(this,n.apply(t,e))}})},t.templateSettings={evaluate:/{%([\s\S]+?)%}/g,interpolate:/{{([\s\S]+?)}}/g,escape:/{{-([\s\S]+?)}}/g};var s=/(.)^/,o={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},r=/\\|'|\r|\n|\u2028|\u2029/g,l=function(e){return"\\"+o[e]};return t.template=function(e,n,i){!n&&i&&(n=i),n=a.extend({},n,t.templateSettings);var o=RegExp([(n.escape||s).source,(n.interpolate||s).source,(n.evaluate||s).source].join("|")+"|$","g"),d=0,g="__p+='";e.replace(o,function(a,t,n,i,s){return g+=e.slice(d,s).replace(r,l),d=s+a.length,t?g+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":n?g+="'+\n((__t=("+n+"))==null?'':__t)+\n'":i&&(g+="';\n"+i+"\n__p+='"),a}),g+="';\n",n.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{var c=Function(n.variable||"obj","_",g)}catch(p){throw p.source=g,p}var u=function(e){return c.call(this,e,t)},m=n.variable||"obj";return u.source="function("+m+"){\n"+g+"}",u},t.init=function(t){return e(t||a)},t}),function(e){"use strict";if("function"==typeof define&&define.amd)define(["jquery"],e);else if("object"==typeof exports)e(require("jquery"));else{if("undefined"==typeof jQuery)throw"gonrin grid requires jQuery to be loaded first";e(jQuery)}}(function(e){"use strict";var a=function(a,t){var n,i=window.gonrin,s={},o={serverPaging:!1,page:1,pageSize:10,pageLinks:5,showGotoPage:!1,showRowsPerPage:!1,showRowsInfo:!1,showRowsDefaultInfo:!0},r={columns:"Columns",columns_show_row_numbers:"Row numbers",columns_default:"Default",sorting:"Sorting",sort_ascending:"<i class='fa fa-chevron-up'></i>&nbsp;&nbsp;",sort_descending:"<i class='fa fa-chevron-down'></i>&nbsp;&nbsp;",sort_none:"<i class='fa fa-minus'></i>&nbsp;&nbsp;",sorting_default:"Default",filters:"Filters",filters_apply:"Apply",filters_reset:"Reset",select:"Select",select_all_in_page:"All in page",deselect_all_in_page:"None in page",select_inverse_in_page:"Inverse",deselect_all:"Deselect all",row_index_header:"#",no_records_found:"No records found",error_load_data:"Error loading data",command_delete_label:"Delete",command_edit_label:"Edit",command_cancel_label:"Cancel",validate_error_message:"Error",validate_success_message:"Successfull"},l=[],d=[],g=[],c=function(){var n,i={};return(a.is("div")||t.inline)&&(n=a.data()),n.dataOptions&&n.dataOptions instanceof Object&&(i=e.extend(!0,i,n.dataOptions)),i},p=function(){return s},u=function(){a.unbind("cellclick").bind("cellclick",t.context?e.proxy(t.onCellClick,t.context):t.onCellClick),a.unbind("rowclick").bind("rowclick",t.context?e.proxy(t.onRowClick,t.context):t.onRowClick),a.unbind("griderror").bind("griderror",t.context?e.proxy(t.onGridError,t.context):t.onGridError),a.unbind("debug").bind("debug",t.context?e.proxy(t.onDebug,t.context):t.onDebug),a.unbind("render").bind("render",t.context?e.proxy(t.onRender,t.context):t.onRender),a.unbind("rowdeleted").bind("rowdeleted",t.context?e.proxy(t.onRowDeleted,t.context):t.onRowDeleted),a.unbind("rowedited").bind("rowedited",t.context?e.proxy(t.onRowEdited,t.context):t.onRowEdited)},m=function(e){a.triggerHandler(e)},b=function(e,a){return e+a},_=function(e){var a="visible";return!e.hasOwnProperty(a)||e.hasOwnProperty(a)&&e[a]===!0},f=function(e){return e.hasOwnProperty("sortable")&&e.sortable!==!1},h=function(){return t.sortableMode},v=function(a){var t=e(a),n=t.closest("tr");if(n){for(var i=n.data("row_data"),s=0;s<d.length;s++)if(d[s]._$row_id===i._$row_id){d.splice(s,1);break}m({type:"rowdeleted",rowData:D(i)}),I()}},w=function(a){a.stopPropagation();e(this);v(this)},L=function(a){a.stopPropagation();var t=e(this),n=t.closest("tr");if(n){var i=n.data("row_data"),s=i._$row_id;m({type:"rowedited",rowUuid:s,rowData:D(i)})}},y=function(n){var s=a.attr("id"),o=b(t.tableIdPrefix,s),l=a.find("#"+o),g=b(t.noResultsIdPrefix,s),c=a.find("#"+g),p=(b(t.filterRulesIdPrefix,s),b(t.paginationIdPrefix,s)),u=a.find("#"+p);l.empty();var h,v,x,B,k,S,E=t.fields,O=E.length;if(v=d.length,x=d.length,h=t.primaryField,n>0)for(B=0;x>B;B++)for(S=0;O>S;S++)k=E[S],_.call(elem,k)&&null==n[B][k.field]&&(n[B][k.field]="");{var R,z,N,j,A,M;parseInt(t.pagination.page),parseInt(t.pagination.pageSize)}A="<thead>",A+='<tr class="grid-header" >',A+="</tr>",A+="</thead>",A+='<tbody class="grid-data">',A+="<tbody>",l.html(A);var q=l.find("thead > tr.grid-header"),U=l.find("tbody.grid-data"),F=!1;for(N in t.fields)if(_(t.fields[N])){if(R="",t.sortable&&f(t.fields[N])&&!F){var J=t.fields[N].sortable,V=!1;if(J&&(V=J.order||!1),V!==!1)switch(F=!0,V){case"asc":R='&nbsp;<span class="'+t.sortingIndicatorAscClass+'"></span>';break;case"desc":R='&nbsp;<span class="'+t.sortingIndicatorDescClass+'"></span>';break;default:R=""}}M=o+"_th_"+t.fields[N].field;var G=e("<th>").attr("id",M).addClass(t.commonThClass).html((t.fields[N].label||t.fields[N].field)+R);t.fields[N].hasOwnProperty("width")&&G.css("width",t.fields[N].width),t.fields[N].hasOwnProperty("headerClass")&&G.addClass(t.fields[N].hasOwnProperty("headerClass")),q.append(G)}for(j in n){z=h?o+"_tr_"+n[j][h]:"";var K=e("<tr>").attr("id",z).data("row_data",n[j]);if(t.rowClass&&("string"==typeof t.rowClass&&K.addClass(t.rowClass),"function"==typeof t.rowClass)){var Y=t.rowClass(n[j]);K.addClass(Y)}n[j]._$row_id&&K.attr("data-uuid",n[j]._$row_id);for(N in t.fields)if(_(t.fields[N])){var H=e("<td>");if(t.fields[N].template&&i.template){var Q=i.template(t.fields[N].template);H.html(Q(n[j]))}else if(t.fields[N].command){var W=t.fields[N].command;e.isArray(W)&&e.each(W,function(a,i){var s=null;"delete"===i?(s=e("<button/>").addClass("btn btn-danger").html(r.command_delete_label),s.bind("click",w)):"edit"===i&&(s=e("<button/>").addClass("btn btn-warning").html(r.command_edit_label),s.bind("click",L)),e.isPlainObject(i)&&i.action&&("delete"===i.action&&(s=e("<button/>").addClass("btn btn-danger").html(i.label||r.command_delete_label),s.bind("click",w)),"edit"===i.action&&(s=e("<button/>").addClass("btn btn-warning").html(i.label||r.command_edit_label),s.bind("click",L)),"function"==typeof i.action&&(s=e("<button/>").addClass("btn").html(i.label||" "),s.bind("click",function(a){a.stopPropagation();var n=e(this),s=n.closest("tr");if(s){var o=s.data("row_data");o=D(o),t.context?i.action.call(t.context,{rowData:o,el:s},i.args||{}):i.action({rowData:o,el:s},i.args||{})}})),i.class&&("function"==typeof i.class&&s.addClass(i.class(n[j])),"string"==typeof i.class&&s.addClass(i.class))),null!=s&&H.append(s)})}else{var Z=n[j][t.fields[N].field];if(t.fields[N].hasOwnProperty("foreign")&&t.fields[N].foreign!==!1){var X=n[j][t.fields[N].foreign],ea=t.fields[N].foreignValueField,aa=t.fields[N].foreignTextField;Z=X&&ea&&"object"==typeof X&&X[ea]===Z?X[aa]||"":""}if(t.fields[N].hasOwnProperty("foreignValues")&&e.isArray(t.fields[N].foreignValues)){var ea=t.fields[N].foreignValueField||"value",aa=t.fields[N].foreignTextField||"text",X=e.grep(t.fields[N].foreignValues,function(e){return e[ea]===Z});X=1==X.length?X[0]:null,Z=X?X[aa]:""}H.text(Z)}t.fields[N].hasOwnProperty("dataClass")&&H.addClass(t.fields[N].hasOwnProperty("dataClass")),K.append(H)}U.append(K)}if(t.pagination!==!1&&void 0!==e.fn.pagination&&u.pagination({refresh:!0,page:t.pagination.page,pageSize:t.pagination.pageSize,totalPages:t.pagination.totalPages,virtualTotalPages:null,onChangePage:function(e){t.pagination.page=e.page,"server"===t.paginationMode?I():y(C())}}),0==v?(u.hide(),c.show()):(u.show(),c.hide()),t.primaryField&&t.selectedItems.length>0&&("single"==t.selectionMode||"multiple"==t.selectionMode)){var ta,na,ia=(o+"_tr_").length;a.find("#"+o+" tbody tr").each(function(){ta=parseInt(e(this).attr("id").substr(ia)),na=P("selected_index",ta),na>-1&&P("mark_selected",ta)})}if(P("update_counter"),t.primaryField&&("single"==t.selectionMode||"multiple"==t.selectionMode)){var ia=(o+"_tr_").length;l.off("click","tbody tr").on("click","tbody tr",function(){var a,n=parseInt(e(this).attr("id").substr(ia)),i=e(this).data("row_data"),s=P("selected_index",i);s>-1?(P("remove_id",s),P("mark_deselected",i),a="deselected"):("single"==t.selectionMode&&(P("clear_all_ids"),P("mark_page_deselected")),P("add_id",i),P("mark_selected",i),a="selected"),P("update_counter"),m({type:"rowclick",rowId:n,rowStatus:a,rowData:D(i),selectedItems:D(t.selectedItems)})})}l.off("click","thead th").on("click","thead th",function(){var a=(o+"_th_").length,n=e(this).attr("id").substr(a);if(t.sortable!==!1){for(var i=!1,s=0;s<t.fields.length;s++){var r=t.fields[s];if(r.field===n){r.hasOwnProperty("sortable")&&r.sortable!==!1&&(i=!0,r.sortable.order="asc"===r.sortable.order?"desc":"asc");break}}if(i){for(var s=0;s<t.fields.length;s++){var r=t.fields[s];r.field!==n&&r.hasOwnProperty("sortable")&&r.sortable!==!1&&(r.sortable.order=!1)}t.pagination.page=1,T(),$(),y(C())}}}),m({type:"render.gonrin"})},C=function(){if("server"!==t.paginationMode){if(0==g.length)return t.pagination.totalPages=0,t.pagination.page=1,g;t.pagination.totalPages=g.length%t.pagination.pageSize==0?g.length/t.pagination.pageSize:parseInt(g.length/t.pagination.pageSize)+1,t.pagination.page>t.pagination.totalPages&&(t.pagination.page=t.pagination.totalPages);var e=[],a=(t.pagination.page-1)*t.pagination.pageSize,n=(t.pagination.page-1)*t.pagination.pageSize+t.pagination.pageSize;n>g.length&&(n=g.length);for(var i=a;n>i;i++)e.push(g[i]);return e}return g},$=function(){var e,a=h(),n=!1;if("client"===a)for(e in t.fields){if(n)break;if(_(t.fields[e])&&f(t.fields[e])){var i=t.fields[e].sortable,s=t.fields[e].field||!1,o=!1,r=!1;if(i&&(r=i.order||!1,o=i.compare||!1),r===!1)continue;if(n=!0,null!=g&&s!==!1)switch(r){case"asc":g.sort(function(e,a){return o!==!1?o(e[s],a[s]):e[s]>a[s]});break;case"desc":g.sort(function(e,a){return o!==!1?o(a[s],e[s]):e[s]<a[s]})}}}},x=function(){if(i&&i.uuid)for(var e=0;e<d.length;e++)d[e]._$row_id=i.uuid()},D=function(a){var t=null;return e.isArray(a)?(t=[],e.each(a,function(e,a){a.hasOwnProperty("_$row_id")&&delete a._$row_id,t.push(a)}),t):"object"==typeof a?(t=e.extend({},a),t.hasOwnProperty("_$row_id")&&delete t._$row_id,t):null},B=function(e){var a,t,n,i;for(i=["fetch"],t=0,n=i.length;n>t;t++)if(a=i[t],!e[a])return!1;return!0},I=function(){if(n=t.dataSource,"object"==typeof n)if(B(n)){t.paginationMode="server",t.filterMode=t.filterMode||"server",t.sortableMode="server";var i=n,s=t.pagination.pageSize,o=t.pagination.page>0?t.pagination.page:1;i.fetch({url:i.url+"?page="+o+"&results_per_page="+s,success:function(){t.pagination.page=i.page,t.pagination.totalPages=i.totalPages,d.splice(0,d.length),i.each(function(e){d.push(e.attributes)}),x(),T(),y(g)},error:function(){var e="ERROR: "+r.error_load_data;a.html('<span style="color: red;">'+e+"</span>"),m({type:"griderror",errorCode:"SERVER_ERROR",errorDescription:e})}})}else e.isArray(n)&&(d=n,x(),T(),$(),y(C()))},k=function(){if(!a.is("div"))throw Error("Cannot apply to non input, select element");if(a.attr("id")||a.attr("id","grid"),l=t.selectedItems||[],t.primaryField)switch(t.selectionMode){case"single":l.length>1&&(l=[]);break;case!1:l=[]}else l=[];var n=a.attr("id");a.removeClass().addClass(t.containerClass);var i=b(t.toolsIdPrefix,n),s=(b(t.columnsListIdPrefix,n),b(t.sortingListIdPrefix,n),b(t.sortingRadioNamePrefix,n)+"_",b(t.selectedRowsIdPrefix,n),b(t.selectionListIdPrefix,n),b(t.tableContainerIdPrefix,n)),o=b(t.tableIdPrefix,n),d=b(t.noResultsIdPrefix,n),g=(b(t.filterToggleIdPrefix,n),b(t.paginationIdPrefix,n)),c=(b(t.filterContainerIdPrefix,n),b(t.filterRulesIdPrefix,n),b(t.filterToolsIdPrefix,n),"");c+='<div id="'+i+'" class="'+t.toolsClass+'"></div>',c+='<div id="'+s+'" class="'+t.datatableContainerClass+'">',c+='<table id="'+o+'" class="'+t.datatableClass+'"></table>',c+="</div>",c+='<div id="'+d+'" class="'+t.noResultsClass+'">'+r.no_records_found+"</div>",c+='<div id="'+g+'"></div>',c+="</div>",a.html(c),a.find("#"+d).hide();var p=a.find("#"+i);p&&p.addClass(t.toolsClass);var u=e("<div>").addClass("btn-group");if(t.tools&&t.tools.length>0){u.appendTo(p);for(var m=0;m<t.tools.length;m++){var _=e("<button>").addClass("btn btn-sm").attr({type:"button",name:t.tools[m].name}).html(t.tools[m].label||t.tools[m].name);_.addClass(t.tools[m].buttonClass||"btn-default"),t.tools[m].command&&(e.isFunction(t.tools[m].command)?_.bind("click",t.context?e.proxy(t.tools[m].command,t.context):t.tools[m].command):"string"==typeof t.tools[m].command&&console.log(t.tools[m].command)),u.append(_)}}I(!0)},P=function(n,i){var s=a.attr("id"),o=b(t.tableIdPrefix,s),r=t.selectedTrClass,l="#"+o+" tbody tr",d="#"+o+"_tr_",g=i?i[t.primaryField]:null;switch(n){case"get_ids":if("single"==t.selectionMode)return t.selectedItems;if("multiple"==t.selectionMode)return t.selectedItems;break;case"clear_all_ids":t.selectedItems=[];break;case"update_counter":var c=b(t.selectedRowsIdPrefix,s);a.find("#"+c).text(t.selectedItems.length);break;case"selected_index":return e.inArray(i,t.selectedItems);case"add_id":t.selectedItems.push(i);break;case"remove_id":t.selectedItems.splice(i,1);break;case"mark_selected":a.find(d+g).addClass(r);break;case"mark_deselected":a.find(d+g).removeClass(r);break;case"mark_page_selected":a.find(l).addClass(r);break;case"mark_page_deselected":a.find(l).removeClass(r);break;case"mark_page_inversed":a.find(l).toggleClass(r)}},T=function(){var e=t.filters;g="server"!==t.filterMode&&null!==e&&i&&i.query?i.query(d,e):d};return s.getVersion=function(){return"0.1.0"},s.options=function(a){if(0===arguments.length)return e.extend(!0,{},t);if(!(a instanceof Object))throw new TypeError("options() options parameter should be an object");return e.extend(!0,t,a),s},s.getOption=function(e){return t[e]},s.getAllOptions=function(){return t},s.deleteRow=v,s.filter=function(e){t.filters=e,T(),$(),y(C())},e.extend(!0,t,c()),t.pagination=e.extend({},o,t.pagination||{}),r=e.extend({},r,t.language||{}),s.options(t),k(),p(),u(),s};e.fn.grid=function(t){return this.each(function(){var n=e(this);t.refresh=t.refresh||!1,n.data("gonrin")&&t.refresh&&n.data("gonrin",null),n.data("gonrin")||(t=e.extend(!0,{},e.fn.grid.defaults,t),n.data("gonrin",a(n,t)))})},e.fn.grid.defaults={refresh:!1,context:null,dataSource:null,primaryField:"",selectionMode:"single",selectedItems:[],sortableMode:"client",fields:[],pagination:null,filters:null,tools:null,showRowNumbers:!1,onCellClick:function(){},onRowClick:function(){},onGridError:function(){},onDebug:function(){},onRender:function(){},onRowDeleted:function(){},onRowEdited:function(){},onValidateError:function(){},onValidateSuccess:function(){},orderMode:!1,filterMode:!1,paginationMode:!1,sortable:{serverOrdering:!1},containerClass:"grid_container",noResultsClass:"alert alert-warning no-records-found",toolsClass:"tools tools_grid",columnsListLaunchButtonClass:"btn btn-default dropdown-toggle",columnsListLaunchButtonIconClass:"fa fa-th",columnsListClass:"dropdown-menu dropdown-menu-right",columnsListLabelClass:"columns-label",columnsListCheckClass:"col-checkbox",columnsListDividerClass:"divider",columnsListDefaultButtonClass:"btn btn-primary btn-xs btn-block",sortingListLaunchButtonIconClass:"fa fa-sort",sortingLabelCheckboxClass:"radio-inline",sortingNameClass:"sorting-name",selectButtonIconClass:"fa  fa-check",selectedRowsClass:"selected-rows",filterToggleButtonIconClass:"fa fa-filter",filterToggleActiveClass:"btn-info",sortingIndicatorAscClass:"fa fa-chevron-up text-muted",sortingIndicatorDescClass:"fa fa-chevron-down text-muted",datatableContainerClass:"table-responsive",datatableClass:"table table-bordered table-hover",commonThClass:"th-common",selectedTrClass:"warning",filterContainerClass:"well filters-container",filterToolsClass:"",filterApplyBtnClass:"btn btn-primary btn-sm filters-button",filterResetBtnClass:"btn btn-default btn-sm filters-button",toolsIdPrefix:"tools_",columnsListIdPrefix:"columns_list_",sortingListIdPrefix:"sorting_list_",sortingRadioNamePrefix:"sort_radio_",selectedRowsIdPrefix:"selectedRows_",selectionListIdPrefix:"selection_list_",filterToggleIdPrefix:"filter_toggle_",tableContainerIdPrefix:"tbl_container_",tableIdPrefix:"tbl_",noResultsIdPrefix:"no_res_",rowClass:"grid_row",paginationIdPrefix:"pag_",filterContainerIdPrefix:"flt_container_",filterRulesIdPrefix:"flt_rules_",filterToolsIdPrefix:"flt_tools_",debugMode:!1}}),function(e){"use strict";if("function"==typeof define&&define.amd)define(["jquery"],e);else if("object"==typeof exports)e(require("jquery"));else{if("undefined"==typeof jQuery)throw"gonrin grid requires jQuery to be loaded first";e(jQuery)}}(function(e){"use strict";var a=function(a,t){var n=(window.gonrin,{}),i={},i={go_to_page_title:"Go to page",rows_per_page_title:"Rows per page",current_page_label:"Page",current_page_abbr_label:"p.",total_pages_label:"of",total_pages_abbr_label:"/",total_rows_label:"of",rows_info_records:"records",go_top_text:"&laquo;",go_prev_text:"&larr;",go_next_text:"&rarr;",go_last_text:"&raquo;"},s=function(e,a){return e+a},o=function(){var n,i={};return(a.is("div")||t.inline)&&(n=a.data()),n.dataOptions&&n.dataOptions instanceof Object&&(i=e.extend(!0,i,n.dataOptions)),i},r=function(e){a.triggerHandler(e)},l=function(){if(!a.is("div"))throw Error("Cannot apply to non input, select element");a.attr("id")||a.attr("id","grid"),a.unbind("changePage").bind("changePage",t.context?e.proxy(t.onChangePage,t.context):t.onChangePage),a.unbind("load").bind("load",t.context?e.proxy(t.onLoad,t.context):t.onLoad);var n,o,r,l,d,c,p,u=a.attr("id"),m=s(t.navListIdPrefix,u),b=s(t.navTopIdPrefix,u),_=s(t.navPrevIdPrefix,u),f=s(t.navItemIdPrefix,u)+"_",h=s(t.navNextIdPrefix,u),v=s(t.navLastIdPrefix,u),w=s(t.navGotoPageIdPrefix,u),L=s(t.navRowsPerPageIdPrefix,u),y=s(t.navRowsInfoIdPrefix,u),C="";C+='<div class="'+t.mainWrapperClass+'">',C+='<div class="'+t.navListContainerClass+'">',C+='<div class="'+t.navListWrapperClass+'">',C+='<ul id="'+m+'" class="'+t.navListClass+'">',C+="</ul>",C+="</div>",C+="</div>",t.showGoToPage&&t.pageLinks<t.totalPages&&(C+='<div class="'+t.navGoToPageContainerClass+'">',C+='<div class="input-group">',C+='<span class="input-group-addon" title="'+i.go_to_page_title+'"><i class="'+t.navGoToPageIconClass+'"></i></span>',C+='<input id="'+w+'" type="text" class="'+t.navGoToPageClass+'" title="'+i.go_to_page_title+'">',C+="</div>",C+="</div>"),t.showRowsPerPage&&(C+='<div class="'+t.navRowsPerPageContainerClass+'">',C+='<div class="input-group">',C+='<span class="input-group-addon" title="'+i.rows_per_page_title+'"><i class="'+t.navRowsPerPageIconClass+'"></i></span>',C+='<input id="'+L+'" value="'+t.pageSize+'" type="text" class="'+t.navRowsPerPageClass+'" title="'+i.rows_per_page_title+'">',C+="</div>",C+="</div>"),t.showRowsInfo&&(C+='<div class="'+t.navInfoContainerClass+'">',C+='<div id="'+y+'" class="'+t.navInfoClass+'"></div>',C+="</div>"),C+="</div>",a.html(C),n=null,o=t.page,g(u,n,o,!0,!1),a.addClass(t.containerClass),t.directURL||(r="#"+b,a.off("click",r).on("click",r,function(){var e=t.page;t.page=1;var a=t.page;g(u,e,a,!0,!0)}),l="#"+_,a.off("click",l).on("click",l,function(){if(t.page>1){var e=t.page;t.page=parseInt(t.page)-1;var n=t.page,i=a.data("nav_start")==e;g(u,e,n,i,!0)}}),c="#"+h,a.off("click",c).on("click",c,function(){if(t.page<t.totalPages){var e=t.page;t.page=parseInt(t.page)+1;var n=t.page,i=a.data("nav_end")==e;g(u,e,n,i,!0)}}),p="#"+v,a.off("click",p).on("click",p,function(){var e=t.page;t.page=parseInt(t.totalPages);var a=t.page;g(u,e,a,!0,!0)}),d='[id^="'+f+'"]',a.off("click",d).on("click",d,function(a){var n=t.page,i=f.length;t.page=parseInt(e(a.target).attr("id").substr(i));var s=t.page;g(u,n,s,!1,!0)}))},d=function(e){return e.attr("unselectable","on").css("user-select","none").on("selectstart",!1)},g=function(e,n,o,l,g){var c=s(t.navItemIdPrefix,e)+"_";if(l){var p,u,m,b,_,f=s(t.navListIdPrefix,e),h=s(t.navTopIdPrefix,e),v=s(t.navPrevIdPrefix,e),w=s(t.navNextIdPrefix,e),L=s(t.navLastIdPrefix,e),y=a.find("#"+f),C="",$=parseInt(t.page),x="",D="javascript:void(0);";for(t.totalPages<t.pageLinks?($=1,p=t.totalPages):(_=Math.ceil(t.totalPages/t.pageLinks),$>t.pageLinks*(_-1)?$=t.totalPages-t.pageLinks+1:(m=$%t.pageLinks,b=0==m?-t.pageLinks+1:-m+1,$+=b),p=$+t.pageLinks-1),a.data("nav_start",$),a.data("nav_end",p),$>1&&(x=t.directURL?t.directURL(1):D,C+='<li><a id="'+h+'" href="'+x+'">'+i.go_top_text+"</a></li>",x=t.directURL?t.directURL($-1):D,C+='<li><a id="'+v+'" href="'+x+'">'+i.go_prev_text+"</a></li>"),u=$;p>=u;u++)x=t.directURL?t.directURL(u):D,C+='<li><a id="'+c+u+'" href="'+x+'">'+u+"</a></li>";p<t.totalPages&&(x=t.directURL?t.directURL(p+1):D,C+='<li><a id="'+w+'" href="'+x+'">'+i.go_next_text+"</a></li>",x=t.directURL?t.directURL(t.totalPages):D,C+='<li><a id="'+L+'" href="'+x+'">'+i.go_last_text+"</a></li>"),y.html(C),t.disableTextSelectionInNavPane&&d(y)}var B=a.find("#"+c+n),I=a.find("#"+c+o);B.closest("li").removeClass(t.navListActiveItemClass),I.closest("li").addClass(t.navListActiveItemClass);var k=i.current_page_label+" "+o+" "+i.total_pages_label+" "+t.totalPages;if(B.prop("title",""),I.prop("title",k),t.showRowsInfo&&t.showRowsDefaultInfo){var P=(t.currentPage-1)*t.pageSize+1,T=Math.min(P+t.pageSize-1,t.totalRows),S=P+"-"+T+" "+i.total_rows_label+" "+t.totalRows+" "+i.rows_info_records+" ("+i.current_page_abbr_label+t.currentPage+i.total_pages_abbr_label+t.totalPages+")",E=s(t.navRowsInfoIdPrefix,e);a.find("#"+E).html(S)}r(g?{type:"changePage",page:o,pageSize:t.pageSize}:{type:"load",page:o,pageSize:t.pageSize})};return n.getVersion=function(){return"0.0.1"},n.options=function(a){if(0===arguments.length)return e.extend(!0,{},t);if(!(a instanceof Object))throw new TypeError("options() options parameter should be an object");return e.extend(!0,t,a),n},n.getOption=function(e){return t[e]},n.getAllOptions=function(){return t},e.extend(!0,t,o()),n.options(t),l(),n};e.fn.pagination=function(t){return this.each(function(){var n=e(this);t.refresh=t.refresh||!1,n.data("gonrin")&&t.refresh&&n.data("gonrin",null),n.data("gonrin")||(t=e.extend(!0,{},e.fn.pagination.defaults,t),n.data("gonrin",a(n,t)))})},e.fn.pagination.defaults={refresh:!1,context:null,page:1,pageSize:10,totalPages:null,virtualTotalPages:null,pageLinks:5,showGotoPage:!1,showRowsPerPage:!1,showRowsInfo:!1,showRowsDefaultInfo:!0,containerClass:"pagination-container",directURL:!1,disableTextSelectionInNavPane:!0,mainWrapperClass:"row",navListContainerClass:"col-xs-12 col-sm-12 col-md-6",navListWrapperClass:"",navListClass:"pagination pagination_custom",navListActiveItemClass:"active",navGoToPageContainerClass:"col-xs-6 col-sm-4 col-md-2 row-space",navGoToPageIconClass:"fa fa-arrow-right",navGoToPageClass:"form-control small-input",navRowsPerPageContainerClass:"col-xs-6 col-sm-4 col-md-2 row-space",navRowsPerPageIconClass:"fa fa-th-list",navRowsPerPageClass:"form-control small-input",navInfoContainerClass:"col-xs-12 col-sm-4 col-md-2 row-space",navInfoClass:"",navListIdPrefix:"nav_list_",navTopIdPrefix:"top_",navPrevIdPrefix:"prev_",navItemIdPrefix:"nav_item_",navNextIdPrefix:"next_",navLastIdPrefix:"last_",navGotoPageIdPrefix:"goto_page_",navRowsPerPageIdPrefix:"rows_per_page_",navRowsInfoIdPrefix:"rows_info_",onChangePage:function(){},onLoad:function(){}}}),function(){var e,a,t,n,i,s,o,r,l,d,g,c,p,u,m,b,f,h,v,w,L,y,C,x,D,B=([].slice,[].indexOf||function(e){for(var a=0,t=this.length;t>a;a++)if(a in this&&this[a]===e)return a;return-1}),I={}.hasOwnProperty;for(b=this,y={},n=function(e){var a,t,n,i;for(i=["every","some","filter","detect","reject","reduce","intersection","isEqual","keys","isArray","result","map"],t=0,n=i.length;n>t;t++)if(a=i[t],y[a]=e[a],!y[a])throw Error(""+a+" missing. Please ensure that you first initialize gonrin.core")},y.getType=function(e){var a;return a=Object.prototype.toString.call(e).substr(8),a.substr(0,a.length-1)},y.makeObj=function(e,a){var t;return(t={})[e]=a,t},y.reverseString=function(e){return e.toLowerCase().split("").reverse().join("")},y.compoundKeys=["$and","$not","$or","$nor"],y.makeGetter=function(e){return e=e.split("."),function(a){var t,n,i,s;for(n=a,i=0,s=e.length;s>i;i++)t=e[i],n&&(n=y.result(n,t));return n}},l=function(e,a){var t,n,i;i=[];for(t in a)n=a[t],i.push(y.makeObj(e,y.makeObj(t,n)));return i},g=function(e){var a,t,n,i,s,o;switch(a=y.keys(e)[0],i=e[a],t={key:a},(void 0!==i?i.$boost:void 0)&&(t.boost=i.$boost,delete i.$boost),-1!==a.indexOf(".")&&(t.getter=y.makeGetter(a)),n=y.getType(i)){case"RegExp":case"Date":t.type="$"+n.toLowerCase(),t.value=i;break;case"Object":if(B.call(y.compoundKeys,a)<0){if(y.keys(i).length>1)t.type="$and",t.value=p(l(a,i)),t.key=null;else for(s in i)if(I.call(i,s)){if(o=i[s],!L(s,o))throw Error("Query value ("+o+") doesn't match query type: ("+s+")");switch(t.type=s,s){case"$elemMatch":t.value=v(c(o));break;case"$endsWith":t.value=y.reverseString(o);break;case"$likeI":case"$startsWith":t.value=o.toLowerCase();break;case"$not":case"$nor":case"$or":case"$and":t.value=p(y.makeObj(t.key,o)),t.key=null;break;case"$computed":t=g(y.makeObj(a,o)),t.getter=y.makeGetter(a);break;default:t.value=o}}}else t.type=a,t.value=p(i),t.key=null;break;default:t.type="$equal",t.value=i}return"$equal"!==t.type||"Object"!==n&&"Array"!==n||(t.type="$deepEqual"),t},p=function(e){var a,t,n,i,s,o,r;for(n=y.isArray(e)?e:function(){var t;t=[];for(a in e)I.call(e,a)&&(i=e[a],t.push(y.makeObj(a,i)));return t}(),r=[],s=0,o=n.length;o>s;s++)t=n[s],r.push(g(t));return r},L=function(e,a){var t;switch(t=y.getType(a),e){case"$in":case"$nin":case"$all":case"$any":return"Array"===t;case"$size":return"Number"===t;case"$regex":case"$regexp":return"RegExp"===t;case"$like":case"$likeI":return"String"===t;case"$between":case"$mod":return"Array"===t&&2===a.length;case"$cb":return"Function"===t;default:return!0}},w=function(e,a){var t;switch(t=y.getType(a),e){case"$like":case"$likeI":case"$regex":case"$startsWith":case"$endsWith":return"String"===t;case"$contains":case"$all":case"$any":case"$elemMatch":return"Array"===t;case"$size":return"String"===t||"Array"===t;case"$in":case"$nin":return null!=a;default:return!0}},u=function(e,a,t,n,i){switch(e){case"$equal":return y.isArray(t)?B.call(t,a)>=0:t===a;case"$deepEqual":return y.isEqual(t,a);case"$contains":return B.call(t,a)>=0;case"$ne":return t!==a;case"$lt":return a>t;case"$gt":return t>a;case"$lte":return a>=t;case"$gte":return t>=a;case"$between":return a[0]<t&&t<a[1];case"$betweene":return a[0]<=t&&t<=a[1];case"$in":return B.call(a,t)>=0;case"$nin":return B.call(a,t)<0;case"$all":return y.every(a,function(e){return B.call(t,e)>=0});case"$any":return y.some(t,function(e){return B.call(a,e)>=0});case"$size":return t.length===a;case"$exists":case"$has":return null!=t===a;case"$like":return-1!==t.indexOf(a);case"$likeI":return-1!==t.toLowerCase().indexOf(a);case"$startsWith":return 0===t.toLowerCase().indexOf(a);case"$endsWith":return 0===y.reverseString(t).indexOf(a);case"$type":return typeof t===a;case"$regex":case"$regexp":return a.test(t);case"$cb":return a.call(n,t);case"$mod":return t%a[0]===a[1];case"$elemMatch":return f(t,a,null,!0);case"$and":case"$or":case"$nor":case"$not":return m(e,a,i,n);default:return!1}},v=function(e,a,t){var n,i;if("String"===y.getType(a)&&(n=a,a=function(e,a){return e[n](a)}),t){if(1!==e.length)throw Error("score operations currently don't work on compound queries");if(i=e[0],"$and"!==i.type)throw Error("score operations only work on $and queries (not "+i.type);return function(e){return e._score=m(i.type,i.parsedQuery,a,e,!0),e}}return function(n){var s,o;for(s=0,o=e.length;o>s;s++)if(i=e[s],!m(i.type,i.parsedQuery,a,n,t))return!1;return!0}},m=function(e,a,t,n,i){var s,o,r,l,d,g,c,p,m,b;for(r=0,d=0,g=1/a.length,p=0,m=a.length;m>p;p++)switch(l=a[p],s=l.getter?l.getter(n,l.key):t?t(n,l.key):n[l.key],c=w(l.type,s),c&&(c=u(l.type,l.value,s,n,t)),c&&(r++,i&&(o=null!=(b=l.boost)?b:1,d+=g*o)),e){case"$and":if(!i&&!c)return!1;break;case"$not":if(c)return!1;break;case"$or":if(c)return!0;break;case"$nor":if(c)return!1;break;default:throw Error("Invalid compound method")}return i?d:"$not"===e?0===r:"$or"!==e},c=function(e){var a,t,n,i,s;if(n=y.keys(e),!n.length)return[];if(a=y.intersection(y.compoundKeys,n),0===a.length)return[{type:"$and",parsedQuery:p(e)}];if(a.length!==n.length){B.call(a,"$and")<0&&(e.$and={},a.unshift("$and"));for(t in e)I.call(e,t)&&(s=e[t],B.call(y.compoundKeys,t)<0&&(e.$and[t]=s,delete e[t]))}return function(){var t,n,s;for(s=[],t=0,n=a.length;n>t;t++)i=a[t],s.push({type:i,parsedQuery:p(e[i])});return s}()},d=function(e){var a;return"String"===y.getType(e)&&(a=e,e=function(e,t){return e[a](t)}),e},e=function(){function e(e,a){this.items=e,this._getter=a,this.theQuery={}}return e.prototype.all=function(e,a){return e&&(this.items=e),e=this.indexes?this.getIndexedItems(this.items):this.items,f(e,this.theQuery,this._getter,a)},e.prototype.chain=function(){return _.chain(this.all.apply(this,arguments))},e.prototype.tester=function(){return r(this.theQuery,this._getter)},e.prototype.first=function(e){return this.all(e,!0)},e.prototype.getter=function(e){return this._getter=e,this},e}(),a=function(e){return function(a,t){var n;return t&&(a=y.makeObj(a,t)),null==(n=this.theQuery)[e]&&(n[e]=[]),this.theQuery[e].push(a),this}},D=y.compoundKeys,C=0,x=D.length;x>C;C++)o=D[C],e.prototype[o.substr(1)]=a(o);return e.prototype.find=e.prototype.query=e.prototype.run=e.prototype.all,t=function(a,t){return new e(a,t)},r=function(e,a){return v(c(e),d(a))},s=function(e,a,t){return f(e,a,t,!0)},f=function(e,a,n,i,s){var o;return arguments.length<2?t.apply(this,arguments):(n&&(n=d(n)),"Function"!==y.getType(a)&&(a=v(c(a),n,s)),(o=s?y.map:i?y.detect:y.filter)(e,a))},h=function(e,a,t){return f(e,a,t,!1,!0)},f.build=t,f.parse=c,f.findOne=f.first=s,f.score=h,f.tester=f.testWith=r,f.getter=f.pluckWith=y.makeGetter,i=function(e,a){return a=!1,n(e),$.extend(e,{query:f,q:f}),f},b.gonrin?i(b.gonrin):exports&&("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=i:i}.call(this);